# AT-1: Первичный анализ

## Дата анализа

23 ноября 2025

## Понимание задачи

### Что нужно сделать

Добавить детализированный вывод результатов команды `aa update`, чтобы пользователь видел не только общую статистику (сколько задач обновлено), но и конкретные детали:
- Какие именно задачи были обновлены
- Что изменилось в названии каждой задачи (старое название → новое название)
- Какой ID был присвоен каждой задаче

### Ожидаемый результат

После выполнения команды `aa update` пользователь должен видеть не только:
```
=== Update Summary ===
Project: AL
  Total tasks processed: 3
  Tasks updated: 3
  Tasks skipped (already have ID): 0
```

Но и детальный список обновлений, например:
```
=== Update Details ===

Project: AL
  AL-132: Implement feature X
    Old: Implement feature X
    New: AL-132 Implement feature X
  
  AL-133: Fix bug Y
    Old: Fix bug Y
    New: AL-133 Fix bug Y
```

### Критерии успеха

- ✅ В выводе команды `aa update` отображаются детали каждого обновления
- ✅ Для каждой обновленной задачи показывается:
  - Присвоенный ID
  - Старое название
  - Новое название
- ✅ Детализация не загромождает вывод (можно ограничить количество или добавить опцию)
- ✅ Существующая функциональность dry-run остается без изменений

## Технический анализ

> **Примечание:** Указано на высоком уровне, БЕЗ глубокого изучения кода

### Затрагиваемые компоненты

- **aa/commands/update.py**: Основной файл команды update
  - Строки 136-161: Код вывода summary
  - Нужно добавить вывод деталей обновлений из `result.updates`
  
- **aa/models/task.py**: Модель TaskUpdate
  - Уже содержит все нужные данные: `task_id`, `old_name`, `new_name`, `assigned_id`
  - Изменений не требуется
  
- **aa/core/task_processor.py**: ProcessingResult
  - Возвращает список обновлений `result.updates`
  - Изменений не требуется

### Зависимости

- Нет внешних зависимостей
- Все необходимые данные уже собираются и хранятся в `TaskUpdate`
- Нужно только добавить вывод в update.py

### Потенциальные риски

- **Большой объем вывода**: Если обновляется много задач (например, 100+), вывод может быть слишком длинным
  - Решение: Добавить лимит (например, показывать первые 20) и опцию `--verbose` для полного вывода
  
- **Консистентность с dry-run**: Сейчас в dry-run режиме уже есть вывод деталей (строки 149-154)
  - Решение: Использовать единый формат для обоих режимов

## Предварительный план реализации

> **Примечание:** Это высокоуровневый набросок, НЕ детальный план!

### Этап 1: Разработка формата вывода

- [ ] Определить формат вывода деталей обновлений
- [ ] Учесть существующий формат в dry-run режиме
- [ ] Создать прототип в `artifacts/`

### Этап 2: Реализация

- [ ] Добавить функцию для форматирования деталей обновлений
- [ ] Интегрировать вывод деталей в update.py (после summary)
- [ ] Добавить опцию `--limit` для ограничения количества выводимых деталей
- [ ] Обновить docstring команды update

### Этап 3: Тестирование

- [ ] Протестировать с малым количеством обновлений (1-3 задачи)
- [ ] Протестировать с большим количеством обновлений (10+ задач)
- [ ] Протестировать dry-run режим (не должен сломаться)
- [ ] Проверить читаемость вывода

## Вопросы и неясности

Нет неясностей. Задача понятна и реализуема.

## Оценка сложности

> **Примечание:** Примерная оценка, основанная только на описании задачи!

- **Сложность:** Низкая
- **Примерное время:** 30-60 минут
- **Уверенность в оценке:** Высокая

**Обоснование:**
- Все необходимые данные уже собираются
- Нужно только добавить вывод в одном месте (update.py)
- Нет сложной логики или взаимодействия с API
- Риски минимальны

